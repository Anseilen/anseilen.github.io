function chaList(){$(function(){if(sessionStorage.getItem("cct")&&(new Date).getTime()-sessionStorage.getItem("cct")<sessionStorage.getItem("cctd")){if(sessionStorage.getItem("citems")){var t=JSON.parse(sessionStorage.getItem("citems"));t.forEach(function(t){var e=t.date.substr(0,10),n=String(t.amount).slice(0,-3)+","+String(t.amount).slice(-3),s=t.cancelled?t.cancelled+"  ©":"    ";$("#chaTable tbody").append("<tr><td>"+e+"</td><td>"+t.coin+"  ©</td><td>"+n+" 원</td><td>"+s+"</td></tr>")})}}else sessionStorage.removeItem("citems");firebase.auth().onAuthStateChanged(function(t){t&&(sessionStorage.getItem("citems")||($("#chaTable tbody tr").remove(),$("#chaTable tbody").append('<tr><td><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></td></tr>'),firebase.auth().currentUser.getIdToken().then(function(t){var e={method:"GET",url:"/api/charges",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t)}};return $.ajax(e).done(function(t){$("#chaTable tbody tr").remove(),t.items.forEach(function(t){var e=t.date.substr(0,10),n=String(t.amount).slice(0,-3)+","+String(t.amount).slice(-3),s=t.cancelled?t.cancelled+"  ©":"    ";$("#chaTable tbody").append("<tr><td>"+e+"</td><td>"+t.coin+"  ©</td><td>"+n+" 원</td><td>"+s+"</td></tr>")}),sessionStorage.setItem("citems",JSON.stringify(t.items))})})))}),this.$getListButton=$("#chaBtn"),this.$appendListButton=$("#chaMoreBtn"),this.$appendListButton.on("click",this.appendList.bind(this)),this.$getListButton.on("click",this.getInitList.bind(this))}.bind(this))}chaList.prototype.getInitList=function(){$("#chaTable tbody tr").remove(),$("#chaTable tbody").append('<tr><td><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></td></tr>'),firebase.auth().currentUser.getIdToken().then(function(t){var e={method:"GET",url:"/api/charges",dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t)}};return $.ajax(e).done(function(t){$("#chaTable tbody tr").remove(),t.items.forEach(function(t){var e=t.date.substr(0,10),n=String(t.amount).slice(0,-3)+","+String(t.amount).slice(-3),s=t.cancelled?t.cancelled+"  ©":"    ";$("#chaTable tbody").append("<tr><td>"+e+"</td><td>"+t.coin+"  ©</td><td>"+n+" 원</td><td>"+s+"</td></tr>")}),sessionStorage.setItem("citems",JSON.stringify(t.items))})})},chaList.prototype.appendList=function(){var t=JSON.parse(sessionStorage.getItem("citems")),e=t[t.length-1].id;firebase.auth().currentUser.getIdToken().then(function(t){var n={method:"GET",url:"/api/charges?last="+e,dataType:"json",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t)}};return $.ajax(n).done(function(t){if(t.items.length){t.items.forEach(function(t){var e=t.date.substr(0,10),n=String(t.amount).slice(0,-3)+","+String(t.amount).slice(-3),s=t.cancelled?t.cancelled+"  ©":"    ";$("#chaTable tbody tr:last-child").after("<tr><td>"+e+"</td><td>"+t.coin+"  ©</td><td>"+n+" 원</td><td>"+s+"</td></tr>")});var e=JSON.parse(sessionStorage.getItem("citems")),n=e.concat(t.items);sessionStorage.setItem("citems",JSON.stringify(n))}else alert("더 이상 조회가능한 내역이 없습니다.")})})},window.sy_cl=new chaList;