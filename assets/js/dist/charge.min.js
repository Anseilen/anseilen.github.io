function chargeSection(){$(function(){this.$priceInput=$("tbody input"),this.$priceInputRadio=$("tbody input:radio"),this.$chargeButton=$("#charge-btn"),this.$priceInput.each(function(e,t){$(t).is(":checked")&&this.setPrice(t.value)}.bind(this)),this.$priceInputRadio.on("change",function(e){this.setPrice(e.target.value)}.bind(this)),this.$chargeButton.on("click",this.charge.bind(this))}.bind(this))}chargeSection.prototype.setPrice=function(e){e?$("#charge-btn").text(e.slice(0,-3)+" ,"+e.slice(-3)+"원 결제하기"):$("#charge-btn").text("결제하기")},chargeSection.prototype.charge=function(e){var t,n,i="ans_"+(new Date).getTime(),a=sessionStorage.getItem("eml");$("tbody input").each(function(e,n){$(n).is(":checked")&&(t=+n.value)}),$("#charge-method__selection input").each(function(e,t){$(t).is(":checked")&&(n=t.value)}),firebase.auth().currentUser.getIdToken().then(function(e){var c={method:"POST",url:"/payments/request",dataType:"text",contentType:"application/json",data:JSON.stringify({merchant_uid:i,amount:t}),beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e)}};return $.ajax(c).done(function(){IMP.request_pay({pg:"html_inicis",pay_method:n,merchant_uid:i,name:"풀다 코인충전 "+t,amount:t,buyer_name:a,buyer_email:a},function(e){if(e.success){var t="결제가 완료되었습니다.";t+="고유ID : "+e.imp_uid,t+="상점 거래ID : "+e.merchant_uid,t+="결제 금액 : "+e.paid_amount,t+="카드 승인번호 : "+e.apply_num,firebase.auth().currentUser.getIdToken().then(function(t){$.ajax({method:"POST",url:"/payments/complete",contentType:"application/json",data:JSON.stringify({imp_uid:e.imp_uid,merchant_uid:e.merchant_uid}),beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+t)}}).done(function(e){sessionStorage.clear(),window.location.replace("/charge")})})}else{var t="결제에 실패하였습니다.";t+="에러내용 : "+e.error_msg}alert(t)})}).fail(function(e,t){console.error(e.status,t),alert("충전에 실패했습니다. 다시 시도해주세요.")})})},window.ch=new chargeSection;